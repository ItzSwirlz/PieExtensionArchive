(()=>{function e(e,t){return chrome.runtime.sendMessage({name:e,payload:t})}function t(e,t=15e3,o=100){return new Promise((c=>{let r=0;const n=setInterval((()=>{const a=document.querySelector(e);a?(clearInterval(n),c(a)):r>t&&clearInterval(n),r+=o}),o)}))}e("adblock:youtubePageLoaded");const o=new Map;function c(e,t,c){return new Promise(((r,n)=>{e?(e.querySelector(t)&&(c(e.querySelector(t)),r(e.querySelector(t))),function(e,t,c){let r=o.get(e);r||(r={watchedSelectors:{}},o.set(e,r),new MutationObserver((e=>{e.forEach((e=>{if("childList"===e.type&&e.addedNodes.length>0){const t=Array.from(e.addedNodes);Object.keys(r.watchedSelectors).forEach((e=>{const o=t.find((t=>t.matches&&t.matches(e)));o&&r.watchedSelectors[e].forEach((e=>e(o)))}))}}))})).observe(e,{childList:!0,subtree:!0}));r.watchedSelectors[t]=r.watchedSelectors[t]||[],r.watchedSelectors[t].push(c)}(e,t,(()=>{c(e.querySelector(t)),r(e.querySelector(t))}))):n(new Error(`Parent element "${e}" not found`))}))}try{document.querySelector('meta[name="apple-itunes-app"]').remove()}catch(e){}!async function(){const o=await e("adblock:getYoutubeSignalsConfig");function r(){window.location.href.includes("watch")&&(Object.entries(o).forEach((([o,r])=>{!function(o,r){const{trigger:n}=o;n&&t(n.parent,15e3,200).then((t=>{c(t,n.selector,(async()=>{const t=await e(`adblock:${r}`,{url:window.location.href});t.shouldRefresh||t.showGracefulFail||(t.elementsToClick&&t.elementsToClick.forEach((e=>{document.querySelector(e).click()})),t.delay&&(await new Promise((e=>{setTimeout(e,t.delay)})),t.elementsToClick.forEach((e=>{document.querySelector(e).click()}))),t.elementsToRemove&&t.elementsToRemove.forEach((e=>{document.querySelector(e).remove()})),t.shouldAutoplay&&document.querySelector(".html5-video-player.paused-mode")&&document.querySelector(".ytp-play-button").click())}))}))}(r,o)})),t(".html5-video-player.playing-mode",15e3,500).then((()=>{document.querySelector(".html5-video-player.ad-created")||e("adblock:youtubeVideoSuccess")})))}r(),function({parent:o=".video-ads",selector:r=".ytp-ad-player-overlay-layout"}={}){t(o).then((t=>{c(t,r,(t=>{const o=t.querySelector(".ytp-visit-advertiser-link__text");let c="";o&&(c=o.textContent),e("adblock:youtubeAdSeen",{adText:c})}))}))}(),window.addEventListener("yt-page-data-updated",r)}()})();